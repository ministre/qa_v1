{% extends "device/wrapper.html" %}

{% load i18n static %}

{% block content %}

<p>
    <a href="{% url 'testplan_pattern_details' pk=test_pattern.category_pattern.testplan_pattern.id tab_id=2 %}">{% trans "Testplan Patterns" %}
        {{ test_pattern.category_pattern.testplan_pattern.name }} ({{ test_pattern.category_pattern.testplan_pattern.version }})</a>
    <br>
    {{ test_pattern.category_pattern }} &raquo; {{ num.0 }}.{{ num.1 }} {{ test_pattern.name }}
</p>

<ul class="tabs" data-tabs id="test_pattern-tabs">
    <li class="tabs-title {% if tab_id == 1 %} is-active{% endif %}">
        <a data-tabs-target="general" href="#general">{% trans "General" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 2 %} is-active{% endif %}">
        <a data-tabs-target="types" href="#types">{% trans "Device Types" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 3 %} is-active{% endif %}">
        <a data-tabs-target="name" href="#name">{% trans "Name" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 4 %} is-active{% endif %}">
        <a data-tabs-target="purpose" href="#purpose">{% trans "Purpose" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 5 %} is-active{% endif %}">
        <a data-tabs-target="procedure" href="#procedure">{% trans "Procedure" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 6 %} is-active{% endif %}">
        <a data-tabs-target="expected" href="#expected">{% trans "Expected result" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 7 %} is-active{% endif %}">
        <a data-tabs-target="configs" href="#configs">{% trans "Configurations" %}
            {% if test_pattern.test_pattern_config.all.count > 0 %}
            ({{ test_pattern.test_pattern_config.all.count }})
            {% endif %}
        </a>
    </li>
    <li class="tabs-title {% if tab_id == 8 %} is-active{% endif %}">
        <a data-tabs-target="images" href="#images">{% trans "Images" %}
            {% if test_pattern.test_pattern_image.all.count > 0 %}
            ({{ test_pattern.test_pattern_image.all.count }})
            {% endif %}
        </a>
    </li>
    <li class="tabs-title {% if tab_id == 9 %} is-active{% endif %}">
        <a data-tabs-target="files" href="#files">{% trans "Files" %}
            {% if test_pattern.test_pattern_file.all.count > 0 %}
            ({{ test_pattern.test_pattern_file.all.count }})
            {% endif %}
        </a>
    </li>
    <li class="tabs-title {% if tab_id == 10 %} is-active{% endif %}">
        <a data-tabs-target="links" href="#links">{% trans "Links" %}
            {% if test_pattern.test_pattern_link.all.count > 0 %}
            ({{ test_pattern.test_pattern_link.all.count }})
            {% endif %}
        </a>
    </li>
    <li class="tabs-title {% if tab_id == 11 %} is-active{% endif %}">
        <a data-tabs-target="comments" href="#comments">{% trans "Comments" %}</a>
    </li>
    <li class="tabs-title {% if tab_id == 12 %} is-active{% endif %}">
        <a data-tabs-target="redmine_wiki" href="#redmine_wiki">Redmine Wiki</a>
    </li>
    <li class="tabs-title {% if tab_id == 13 %} is-active{% endif %}">
        <a data-tabs-target="redmine" href="#redmine">Redmine</a>
    </li>
</ul>

<div class="tabs-content" data-tabs-content="test_pattern-tabs">
    <div class="tabs-panel {% if tab_id == 1 %}is-active{% endif %}" id="general">
        <a href="{% url 'test_pattern_update' pk=test_pattern.id %}" class="button small">{% trans "Update" %}</a>
        <a href="{% url 'test_pattern_delete' pk=test_pattern.id %}" class="button alert small">{% trans "Delete" %}</a>
        <div class="grid-x grid-margin-x">
            <div class="cell">
                <div class="card">
                    <div class="card-section">
                        <table class="unstriped">
                            <tr>
                                <td>ID:</td>
                                <td>{{ test_pattern.id }}</td>
                            </tr>
                            <tr>
                                <td>{% trans "Name" %}:</td>
                                <td>{{ test_pattern }}</td>
                            </tr>
                            <tr>
                                <td>{% trans "Category" %}:</td>
                                <td>{{ test_pattern.category_pattern }}</td>
                            </tr>
                            <tr>
                                <td>{% trans "Redmine Wiki" %}:</td>
                                <td>{% if test_pattern.redmine_wiki %}{{ test_pattern.redmine_wiki }}{% endif %}</td>
                            </tr>
                            <tr>
                                <td>{% trans "Created" %}:</td>
                                <td>{{ test_pattern.created_at }} {% if test_pattern.created_by %}({{ test_pattern.created_by }}){% endif %}</td>
                            </tr>
                            <tr>
                                <td>{% trans "Last Update" %}:</td>
                                <td>{{ test_pattern.updated_at }} {% if test_pattern.updated_by %}({{ test_pattern.updated_by }}){% endif %}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 2 %}is-active{% endif %}" id="types">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_pattern_device_types_update' pk=test_pattern.id %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ device_types_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 3 %}is-active{% endif %}" id="name">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_names_update' %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ test_names_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 4 %}is-active{% endif %}" id="purpose">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_purposes_update' %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ test_purposes_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 5 %}is-active{% endif %}" id="procedure">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_procedures_update' %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ test_procedures_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 6 %}is-active{% endif %}" id="expected">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_expected_update' %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ test_expected_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 7 %}is-active{% endif %}" id="configs">
        <a href="{% url 'test_pattern_config_create' test_pattern_id=test_pattern.id %}" class="button small">{% trans "Add" %}</a>
        {% if test_pattern.test_pattern_config.all %}
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    {% for config in test_pattern.test_pattern_config.all|dictsort:"id" %}
                    <p>
                        {% if config.desc %}{{ config.desc }}{% endif %}
                        <a href="{% url 'test_pattern_config_update' pk=config.id %}"><i class="step fi-pencil" style="color: #7700ff"></i></a>
                        <a href="{% url 'test_pattern_config_delete' pk=config.id %}"><i class="step fi-minus" style="color: red"></i></a>
                    </p>
                    <pre><code data-language="{{ config.lang }}">{{ config.config }}</code></pre>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <div class="tabs-panel {% if tab_id == 8 %}is-active{% endif %}" id="images">
        <div class="grid-x grid-margin-x">
            <div class="cell">
                <div class="card">
                    <div class="card-section">
                        <a href="{% url 'test_pattern_image_create' test_pattern_id=test_pattern.id %}" class="button small">{% trans "Add" %}</a>
                        {% for image in test_pattern.test_pattern_image.all|dictsort:"id" %}
                        <p>
                            {% if image.desc %}{{ image.desc }}{% endif %}
                            <a href="{% url 'test_pattern_image_update' pk=image.id %}"><i class="step fi-pencil" style="color: #7700ff"></i></a>
                            <a href="{% url 'test_pattern_image_delete' pk=image.id %}"><i class="step fi-minus" style="color: red"></i></a>
                        </p>
                        <p>
                            <img src="{{ image.image.url }}"{% if image.width %} width="{{ image.width }}"{% endif %}{% if image.height %} height="{{ image.height }}"{% endif %}>
                        </p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 9 %}is-active{% endif %}" id="files">
        <a href="{% url 'test_pattern_file_create' test_pattern_id=test_pattern.id %}" class="button small">{% trans "Add" %}</a>
        {% if result.result_file.all %}
        <div class="grid-x grid-margin-x">
            <div class="cell">
                <div class="card">
                    <div class="card-section">
                        <ul>
                        {% for file in result.result_file.all|dictsort:"id" %}
                            <li>{% if file.desc %}{{ file.desc }}<br>{% endif %}
                                <a href="{% url 'test_pattern_file_update' pk=file.id %}">{{ file.filename }}</a>
                                <a href="{% url 'test_pattern_file_delete' pk=file.id %}"><i class="step fi-minus" style="color: red"></i></a>
                            </li>
                        {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <div class="tabs-panel {% if tab_id == 10 %}is-active{% endif %}" id="links">
        <a href="{% url 'test_pattern_link_create' test_pattern_id=test_pattern.id %}" class="button small">{% trans "Add" %}</a>
        {% if test_pattern.test_pattern_link.all %}
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    {% for link in test_pattern.test_pattern_link.all|dictsort:"id" %}
                    <p>
                        {% if link.desc %}{{ link.desc }}{% endif %}
                        <a href="{% url 'test_pattern_link_update' pk=link.id %}"><i class="step fi-pencil" style="color: #7700ff"></i></a>
                        <a href="{% url 'test_pattern_link_delete' pk=link.id %}"><i class="step fi-minus" style="color: red"></i></a>
                        <br>
                        <a href="{{ link.url }}">{{ link.url }}</a>
                    </p>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <div class="tabs-panel {% if tab_id == 11 %}is-active{% endif %}" id="comments">
    </div>

    <div class="tabs-panel {% if tab_id == 12 %}is-active{% endif %}" id="redmine_wiki">
        <div class="cell">
            <div class="card">
                <div class="card-section">
                    <form method="post" action="{% url 'test_redmine_wiki_update' %}">
                        <input type="submit" value='{% trans "Update" %}' class="button success small" />
                        {% csrf_token %}
                        {{ test_redmine_wiki_update_form }}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="tabs-panel {% if tab_id == 13 %}is-active{% endif %}" id="redmine">
    </div>

</div>

<script src="{% static 'rainbow/rainbow-custom.min.js' %}"></script>

{% endblock %}
